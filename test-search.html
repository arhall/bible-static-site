<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Test - Explore Scripture</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="container">
        <h1>Explore Scripture Search Test</h1>
        
        <div id="search-container" class="search-container">
            <!-- Search interface will be injected here -->
        </div>
        
        <div style="margin-top: 2rem; padding: 1rem; background: #f8fafc; border-radius: 0.5rem;">
            <h2>Test searches:</h2>
            <ul>
                <li><strong>Books:</strong> Try "Genesis", "Matthew", "Psalms"</li>
                <li><strong>Characters:</strong> Try "Abraham", "Jesus", "Moses"</li>
                <li><strong>Categories:</strong> Try "Law", "Gospels", "Prophets"</li>
                <li><strong>Chapters:</strong> Try "Genesis 1", "John 3", "Psalm 23"</li>
            </ul>
        </div>
        
        <div id="debug-info" style="margin-top: 2rem; padding: 1rem; background: #fef3c7; border-radius: 0.5rem;">
            <h3>Debug Information:</h3>
            <p id="search-engine-status">Search engine status: Loading...</p>
            <p id="search-interface-status">Search interface status: Loading...</p>
            <p id="data-status">Search data status: Loading...</p>
        </div>
    </div>

    <!-- Load the module loader and search components -->
    <script src="/assets/module-loader.js"></script>
    
    <script>
        // Debug information
        function updateStatus() {
            const engineStatus = document.getElementById('search-engine-status');
            const interfaceStatus = document.getElementById('search-interface-status');
            const dataStatus = document.getElementById('data-status');
            
            // Check search engine
            if (window.searchEngine) {
                if (window.searchEngine.initialized) {
                    engineStatus.textContent = `Search engine status: ✅ Ready (${window.searchEngine.indices.size} indices)`;
                } else {
                    engineStatus.textContent = 'Search engine status: ⏳ Initializing...';
                }
            } else {
                engineStatus.textContent = 'Search engine status: ❌ Not loaded';
            }
            
            // Check search interface
            if (window.searchInterface) {
                if (window.searchInterface.isInitialized) {
                    interfaceStatus.textContent = 'Search interface status: ✅ Ready';
                } else {
                    interfaceStatus.textContent = 'Search interface status: ⏳ Initializing...';
                }
            } else {
                interfaceStatus.textContent = 'Search interface status: ❌ Not loaded';
            }
            
            // Check data availability
            fetch('/assets/data/search-data.json')
                .then(response => response.ok ? response.json() : Promise.reject('Failed to load'))
                .then(data => {
                    dataStatus.textContent = `Search data status: ✅ Loaded (${data.books.length} books, ${data.characters.length} characters, ${data.categories.length} categories)`;
                })
                .catch(() => {
                    dataStatus.textContent = 'Search data status: ❌ Failed to load';
                });
        }
        
        // Update status periodically
        updateStatus();
        setInterval(updateStatus, 1000);
        
        // Test search functionality when ready
        window.addEventListener('searchEngineReady', () => {
            console.log('🔍 Search engine is ready!');
            
            // Test some searches
            setTimeout(() => {
                if (window.searchEngine) {
                    console.log('Testing search for "Genesis":', window.searchEngine.search('Genesis'));
                    console.log('Testing search for "Abraham":', window.searchEngine.search('Abraham'));
                    console.log('Testing search for "Law":', window.searchEngine.search('Law'));
                }
            }, 500);
        });
    </script>
</body>
</html>